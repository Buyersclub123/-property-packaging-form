---
description: Critical security, testing, and deployment safeguards
globs: "**/*"
alwaysApply: true
---
# DEVELOPMENT & DEPLOYMENT GUARDRAILS

<CRITICAL_SECURITY>
- **ZERO HARDCODING:** Never hardcode API keys, secrets, or credentials.
- **ENV MANAGEMENT:** Use `.env.local` for local development and Vercel Environment Variables for production.
- **SYNC:** Ensure .env.local keys exist in the Vercel dashboard before deployment.
</CRITICAL_SECURITY>

<STRICT_WORKFLOW>
1. **FIX CREATED:** Code is written locally but UNTESTED (after explicit approval).
2. **FIX TESTED:** Code is verified working in local Dev environment (after explicit approval).
3. **GIT COMMIT:** Commit after each completed item.
4. **PERMISSION:** Ask "May I deploy to Vercel?" after Fix is Tested. 
5. **DEPLOY:** Only execute `git push` or Vercel deploy after explicit "Yes".
</STRICT_WORKFLOW>

<TERMINOLOGY_REQUIREMENTS>
- Use "Fix created in Dev" for local code changes.
- Use "Fix tested in Dev" ONLY after successful local verification.
- Use "Backup committed to git" when changes are committed locally.
- Use "Fix deployed to Vercel" ONLY after the Vercel build completes successfully.
</TERMINOLOGY_REQUIREMENTS>

<ERROR_HANDLING>
- If a task fails, state "I made a mistake" directly.
- Check your own code implementation before suggesting external API or system issues.
- If the user says "STOP", cease all operations immediately.
</ERROR_HANDLING>

<PORTAL_DEPLOYMENT_ROUTE>
**Route to Prod for Portal Changes:**

- Edit ONLY: `property-review-system/form-app/public/portal/index.html`
- **DO NOT edit `property-review-system/portal/index.html` - OLD REPO - WRONG FILE**
- Check git status: `cd form-app; git status` - verify ONLY portal file changed
- **DO NOT commit unrelated files (Step5Proximity.tsx, upload routes, etc.)**
- If other files show as modified: `git restore <filename>` to discard them
- Commit portal only: `cd form-app; git add public/portal/index.html; git commit -m "message"; git push origin main`
- **Request permission from user to trigger Vercel deployment**
- After approval, deploy: `cd form-app; $env:VERCEL_TOKEN="RVE0quS0k8s5yNzlLzcmHIyz"; vercel deploy --prod --yes`
- Verify: `https://property-packaging-form.vercel.app/portal/`
</PORTAL_DEPLOYMENT_ROUTE>