You are an expert Implementation Agent using Claude Sonnet 4.5. 

My goal is to fix 6 Hotspotting/Investment Highlights issues in the Property Review System form application (Next.js/TypeScript/React).

Conduct a deep analysis of my codebase for this task. Create a comprehensive implementation plan including file paths, logic changes, and potential risks. 

Output your plan in a specialized document: batches/batch-1/PROPOSED-SOLUTION-BATCH-1.md

This document must include all necessary context and constraints so you don't need to ask me questions.

---

CONTEXT - READ THESE FIRST:

1. batches/batch-1/IMPLEMENTATION-BRIEF-BATCH-1.md
   Contains the 6 items you need to fix:
   - Item 1: Valid Period extraction error handling
   - Item 2: File naming (remove suburb prefix)
   - Item 3: "Regional" in heading (DOCUMENT ONLY - Make.com issue)
   - Item 4: Missing 7 edit fields (needs investigation)
   - Item 5: Auto-populate PDF link
   - Item 6: Checkbox retention on Page 6

2. batches/batch-1/HANDOFF-TO-IMPLEMENTATION-AGENT.md
   Your onboarding guide with process, rules, and examples

---

YOUR TASK:

Step 1: RESEARCH (Use Plan Mode - Shift+Tab)
- Read both documents above thoroughly
- Research the codebase to understand current implementation
- Review these key files:
  * src/components/steps/step5/InvestmentHighlightsField.tsx
  * src/components/steps/Step5Proximity.tsx
  * src/app/api/investment-highlights/organize-pdf/route.ts
  * src/app/api/investment-highlights/generate-summary/route.ts
  * src/app/api/investment-highlights/save/route.ts
  * src/store/formStore.ts

Step 2: CREATE PROPOSAL
Create batches/batch-1/PROPOSED-SOLUTION-BATCH-1.md with:

For each of the 6 items, document:
- Analysis of current implementation (with file paths and line numbers)
- Proposed changes (with before/after code snippets)
- Rationale for your approach
- Potential risks and edge cases
- Testing approach

Use this structure:

```markdown
# Proposed Solution - Batch 1: Hotspotting Fixes

## üìä Analysis Summary
[Overview of current implementation across all 6 items]

## üîß Proposed Changes

### Item 1: Valid Period Extraction
**Current Implementation** (file:line):
[Code snippet showing current behavior]

**Analysis**:
[What you found, why it's not working]

**Proposed Changes** (file:line):
[Code snippet showing your solution]

**Rationale**: [Why this approach]
**Risks**: [Potential issues]
**Testing**: [How to verify]

[Repeat for Items 2-6]

## ‚ö†Ô∏è Architectural Considerations
[Any concerns or questions]

## üìã Implementation Order
1. [Which item to do first and why]
2. [Second item]
...

## ‚úÖ Ready for Approval
- [ ] All 6 items analyzed
- [ ] Changes documented with file paths and line numbers
- [ ] Risks identified
- [ ] Testing approach defined

**Awaiting approval to proceed with implementation.**
```

Step 3: STOP AND WAIT
After creating PROPOSED-SOLUTION-BATCH-1.md, say:

"‚úÖ PROPOSED SOLUTION READY

I've completed my analysis and created batches/batch-1/PROPOSED-SOLUTION-BATCH-1.md.

Summary:
- Analyzed [X] files
- Identified [Y] changes needed
- Documented approach for all 6 items
- Identified [Z] potential risks

‚è∏Ô∏è AWAITING APPROVAL - I will not execute any changes until you explicitly approve.

üìã NEXT STEP: Tell your Planning Agent (in the other chat) to review batches/batch-1/PROPOSED-SOLUTION-BATCH-1.md and provide approval/rejection/modifications."

Then STOP. Do not proceed further.

---

Step 4: AFTER APPROVAL - EXECUTE AND REPORT
Once I say "Approved. Please proceed.":

1. Execute changes for each item in your proposed order
2. After EACH item is complete, provide a status update
3. When ALL items are complete, create batches/batch-1/COMPLETION-REPORT-BATCH-1.md

Use this structure for the completion report:

```markdown
# Completion Report - Batch 1: Hotspotting Fixes

**Date**: [Date]
**Implementation Agent**: Claude Sonnet 4.5

## ‚úÖ Completed Items

### Item 1: Valid Period Extraction
- Status: ‚úÖ Complete / ‚ö†Ô∏è Partial / ‚ùå Blocked
- Changes Made: [Summary]
- Files Modified: [List with line numbers]
- Testing: [Results]
- Notes: [Any observations]

[Repeat for Items 2-6]

## üêõ New Issues Discovered
1. [Issue description]
   - Severity: High/Medium/Low
   - Location: [file:line]
   - Recommended Action: [suggestion]

## üìù Implementation Notes
[Any important observations, decisions made, or recommendations]

## üéØ Next Steps for User
- [ ] Review the diff in Cursor
- [ ] Test the changes locally
- [ ] Bring this report to Planning Agent for tracker updates
- [ ] Planning Agent will update IMMEDIATE-FIXES-REQUIREMENTS.md
- [ ] Planning Agent will update PRIORITY-CHECKLIST.md

## üìä Summary
- Total items: 6
- Completed: [X]
- Partial: [Y]
- Blocked: [Z]
- New issues found: [N]
- Files modified: [List]
```

After creating the completion report, say:

"‚úÖ BATCH 1 IMPLEMENTATION COMPLETE

All 6 items have been addressed. Completion report created: batches/batch-1/COMPLETION-REPORT-BATCH-1.md

Summary:
- [X] items completed
- [Y] items partial/blocked
- [Z] new issues discovered
- [N] files modified

‚è∏Ô∏è READY FOR DIFF REVIEW - Please review all changes before committing.

üìã NEXT STEP: Tell your Planning Agent (in the other chat) that Batch 1 is complete. They will:
- Read batches/batch-1/COMPLETION-REPORT-BATCH-1.md
- Update IMMEDIATE-FIXES-REQUIREMENTS.md progress tracker
- Update PRIORITY-CHECKLIST.md (mark items complete)
- Add new issues to appropriate checklists
- Prepare next batch if needed"

Then STOP. Do not commit any changes.

---

CRITICAL CONSTRAINTS:

1. ‚õî DO NOT execute any code changes until I explicitly say "Approved. Please proceed."
2. ‚õî DO NOT commit any changes (I will review the diff first)
3. ‚õî If you encounter an architectural conflict not covered in the plan, STOP and describe the issue
4. ‚úÖ DO provide specific file paths and line numbers in your proposal
5. ‚úÖ DO include before/after code snippets
6. ‚úÖ DO identify risks and edge cases
7. ‚úÖ DO save your proposal in: batches/batch-1/PROPOSED-SOLUTION-BATCH-1.md

---

SPECIAL NOTES:

- Item 3 ("Regional" in heading) is a Make.com issue, NOT a form issue. Just document this in your proposal and recommend closing it with no form changes.
- Item 4 (7 edit fields) needs investigation - the code looks correct but isn't working. Focus your analysis here.
- Total estimated effort: 10-12 hours once approved

---

Ready to begin? Please confirm you understand the task, then use Plan Mode (Shift+Tab) to start your codebase research.
